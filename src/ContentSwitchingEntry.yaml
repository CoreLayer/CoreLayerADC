name: ContentSwitchingEntry
dependencies:
  - Core
placeholders:
  - name: PLH_EXP_CSP_ENTRY_HTTP
    expression: EXP__V__CSP_ENTRY_HTTP 
  - name: PLH_EXP_CSP_ENTRY_SSL
    expression: EXP__V__CS_ENTRY_SSL
  - name: PLH_EXP_CSP_ENTRY_TCP
    expression: EXP__V__CSP_ENTRY_TCP
  - name: PLH_EXP_CSP_ENTRY_SSLTCP
    expression: EXP__V__CSP_ENTRY_SSLTCP
  - name: PLH_EXP_CSP_ENTRY_UDP
    expression: EXP__V__CSP_ENTRY_UDP

  - name: PLH_CSL_ENTRY_HTTP
    expression: CSL__V__ENTRY_HTTP
  - name: PLH_CSL_ENTRY_TCP
    expression: CSL__V__ENTRY_TCP
  - name: PLH_CSL_ENTRY_UDP
    expression: CSL__V__ENTRY_UDP

  - name: PLH_LOG_CSP_ENTRY_HTTP
    expression: LOG__V__CSP_ENTRY_HTTP
  - name: PLH_LOG_CSP_ENTRY_SSL
    expression: LOG__V__CSP_ENTRY_SSL
  - name: PLH_LOG_CSP_ENTRY_TCP
    expression: LOG__V__CSP_ENTRY_TCP
  - name: PLH_LOG_CSP_ENTRY_SSLTCP
    expression: LOG__V__CSP_ENTRY_SSLTCP
  - name: PLH_LOG_CSP_ENTRY_UDP
    expression: LOG__V__CSP_ENTRY_UDP

sections:
  - name: Auditing.MessageActions
    elements:
      - name: LOG_CSP_ENTRY_HTTP
        references:
          - PLH_LOG_CSP_ENTRY_HTTP
          - PLH_PSM_CS_TCP_KEY
        expressions:
          install: add audit messageAction PLH_LOG_CSP_ENTRY_HTTP INFO q{PLH_PSM_CS_TCP_KEY + "policy=CSP_ENTRY_HTTP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_ENTRY_HTTP

      - name: LOG_CSP_ENTRY_SSL
        references:
          - PLH_LOG_CSP_ENTRY_SSL
          - PLH_PSM_CS_TCP_KEY
        expressions:
          install: add audit messageAction PLH_LOG_CSP_ENTRY_SSL INFO q{PLH_PSM_CS_TCP_KEY + "policy=CSP_ENTRY_SSL"}
          uninstall: rm audit messageAction PLH_LOG_CSP_ENTRY_SSL

      - name: LOG_CSP_ENTRY_TCP
        references:
          - PLH_LOG_CSP_ENTRY_TCP
          - PLH_PSM_CS_TCP_KEY
        expressions:
          install: add audit messageAction PLH_LOG_CSP_ENTRY_TCP INFO q{PLH_PSM_CS_TCP_KEY + "policy=CSP_ENTRY_TCP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_ENTRY_TCP

      - name: LOG_CSP_ENTRY_SSLTCP
        references:
          - PLH_LOG_CSP_ENTRY_SSLTCP
          - PLH_PSM_CS_TCP_KEY
        expressions:
          install: add audit messageAction PLH_LOG_CSP_ENTRY_SSLTCP INFO q{PLH_PSM_CS_TCP_KEY + "policy=CSP_ENTRY_SSLTCP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_ENTRY_SSLTCP

      - name: LOG_CSP_ENTRY_UDP
        references:
          - PLH_LOG_CSP_ENTRY_UDP
          - PLH_PSM_CS_TCP_KEY
        expressions:
          install: add audit messageAction PLH_LOG_CSP_ENTRY_UDP INFO q{PLH_PSM_CS_UDP_KEY + "policy=CSP_ENTRY_UDP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_ENTRY_UDP

  - name: AppExpert.AdvancedExpressions
    elements:       
      - name: EXP_CSP_ENTRY_HTTP
        references:
          - PLH_PSM_CS
          - PLH_PSM_CSGROUP
          - PLH_EXP_CSP_ENTRY_HTTP
          - PLH_PSM_CS_TCP_KEY_EXISTS
          - PLH_PSM_CSGROUP_TCP_KEY_EXISTS
        dependencies:
          - PSM_CS
          - PSM_CSGROUP
          - PSM_FQDN
        expressions:
          install: add policy expression PLH_EXP_CSP_ENTRY_HTTP q{PLH_PSM_CS_TCP_KEY_EXISTS && PLH_PSM_CSGROUP_TCP_KEY_EXISTS}
          uninstall: rm policy expression PLH_EXP_CSP_ENTRY_HTTP
      - name: EXP_CSP_ENTRY_SSL
        references:
          - PLH_PSM_CS
          - PLH_PSM_CSGROUP
          - PLH_EXP_CSP_ENTRY_SSL
          - PLH_PSM_CS_TCP_KEY_EXISTS
          - PLH_PSM_CSGROUP_TCP_KEY_EXISTS
        expressions:
          install: add policy expression PLH_EXP_CSP_ENTRY_SSL q{PLH_PSM_CS_TCP_KEY_EXISTS && PLH_PSM_CSGROUP_TCP_KEY_EXISTS}
          uninstall: rm policy expression PLH_EXP_CSP_ENTRY_SSL
      - name: EXP_CSP_ENTRY_TCP
        references:
          - PLH_PSM_CS
          - PLH_PSM_CSGROUP
          - PLH_EXP_CSP_ENTRY_TCP
          - PLH_PSM_CS_TCP_KEY_EXISTS
          - PLH_PSM_CSGROUP_TCP_KEY_EXISTS
        expressions:
          install: add policy expression PLH_EXP_CSP_ENTRY_TCP q{PLH_PSM_CS_TCP_KEY_EXISTS && PLH_PSM_CSGROUP_TCP_KEY_EXISTS}
          uninstall: rm policy expression PLH_EXP_CSP_ENTRY_TCP
      - name: EXP_CSP_ENTRY_SSLTCP
        references:
          - PLH_PSM_CS
          - PLH_PSM_CSGROUP
          - PLH_EXP_CSP_ENTRY_SSLTCP
          - PLH_PSM_CS_TCP_KEY_EXISTS
          - PLH_PSM_CSGROUP_TCP_KEY_EXISTS
        expressions:
          install: add policy expression PLH_EXP_CSP_ENTRY_SSLTCP q{PLH_PSM_CS_TCP_KEY_EXISTS && PLH_PSM_CSGROUP_TCP_KEY_EXISTS}
          uninstall: rm policy expression PLH_EXP_CSP_ENTRY_SSLTCP
      - name: EXP_CSP_ENTRY_UDP
        references:
          - PLH_PSM_CS
          - PLH_PSM_CSGROUP
          - PLH_EXP_CSP_ENTRY_UDP
          - PLH_PSM_CS_TCP_KEY_EXISTS
          - PLH_PSM_CSGROUP_TCP_KEY_EXISTS
        expressions:
          install: add policy expression PLH_EXP_CSP_ENTRY_UDP q{PLH_PSM_CS_UDP_KEY_EXISTS && PLH_PSM_CSGROUP_UDP_KEY_EXISTS}
          uninstall: rm policy expression PLH_EXP_CSP_ENTRY_UDP

  - name: TrafficManagement.ContentSwitching.ContentSwitchingPolicyLabels
    elements:
      - name: CSL_ENTRY_HTTP
        references:
          - PLH_CSL_ENTRY_HTTP
        expressions:
          install: add cs policylabel PLH_CSL_ENTRY_HTTP HTTP
          uninstall: rm cs policylabel PLH_CSL_ENTRY_HTTP

      - name: CSL_ENTRY_TCP
        references:
          - PLH_CSL_ENTRY_TCP
        expressions:
          install: add cs policylabel PLH_CSL_ENTRY_TCP TCP
          uninstall: rm cs policylabel PLH_CSL_ENTRY_TCP

      - name: CSL_ENTRY_UDP
        references:
          - PLH_CSL_ENTRY_UDP
        expressions:
          install: add cs policylabel PLH_CSL_ENTRY_UDP UDP
          uninstall: rm cs policylabel PLH_CSL_ENTRY_UDP