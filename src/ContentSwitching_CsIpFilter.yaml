name: ContentSwitching_CsIpFilter
dependencies:
  - Core
  - ContentSwitchingEntry
placeholders:
  - name: PLH_CSL_CSIPFILTER_HTTP
    expression: CSL__V__CSIPFILTER_HTTP
  - name: PLH_CSL_CSIPFILTER_TCP
    expression: CSL__V__CSIPFILTER_TCP
  - name: PLH_CSL_CSIPFILTER_UDP
    expression: CSL__V__CSIPFILTER_UDP

  - name: PLH_LOG_CSP_CSIPFILTER_HTTP
    expression: LOG__V__CSP_CSIPFILTER_HTTP
  - name: PLH_LOG_CSP_CSIPFILTER_TCP
    expression: LOG__V__CSP_CSIPFILTER_TCP
  - name: PLH_LOG_CSP_CSIPFILTER_UDP
    expression: LOG__V__CSP_CSIPFILTER_UDP

  - name: PLH_CSP_CSIPFILTER_HTTP
    expression: CSP__V__CSIPFILTER_HTTP
  - name: PLH_CSP_CSIPFILTER_TCP
    expression: CSP__V__CSIPFILTER_TCP
  - name: PLH_CSP_CSIPFILTER_UDP
    expression: CSP__V__CSIPFILTER_UDP


  
  - name: PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP
    expression: LOG__V__CSP_CSIPFILTER_IPV4_HTTP
  - name: PLH_LOG_CSP_CSIPFILTER_IPV4_TCP
    expression: LOG__V__CSP_CSIPFILTER_IPV4_TCP
  - name: PLH_LOG_CSP_CSIPFILTER_IPV4_UDP
    expression: LOG__V__CSP_CSIPFILTER_IPV4_UDP
  
  - name: PLH_LOG_CSP_CSIPFILTER_IPV6_HTTP
    expression: LOG__V__CSP_CSIPFILTER_IPV6_HTTP
  - name: PLH_LOG_CSP_CSIPFILTER_IPV6_TCP
    expression: LOG__V__CSP_CSIPFILTER_IPV6_TCP
  - name: PLH_LOG_CSP_CSIPFILTER_IPV6_UDP
    expression: LOG__V__CSP_CSIPFILTER_IPV6_UDP



  - name: PLH_CSP_CSIPFILTER_IPV4_HTTP
    expression: CSP__V__CSIPFILTER_IPV4_HTTP
  - name: PLH_CSP_CSIPFILTER_IPV4_TCP
    expression: CSP__V__CSIPFILTER_IPV4_TCP
  - name: PLH_CSP_CSIPFILTER_IPV4_UDP
    expression: CSP__V__CSIPFILTER_IPV4_UDP
  
  - name: PLH_CSP_CSIPFILTER_IPV6_HTTP
    expression: CSP__V__CSIPFILTER_IPV6_HTTP
  - name: PLH_CSP_CSIPFILTER_IPV6_TCP
    expression: CSP__V__CSIPFILTER_IPV6_TCP
  - name: PLH_CSP_CSIPFILTER_IPV6_UDP
    expression: CSP__V__CSIPFILTER_IPV6_UDP



  - name: PLH_CSL_CSIPFILTER_IPV4_HTTP
    expression: CSL__V__CSIPFILTER_IPV4_HTTP
  - name: PLH_CSL_CSIPFILTER_IPV6_HTTP
    expression: CSL__V__CSIPFILTER_IPV6_HTTP

  - name: PLH_CSL_CSIPFILTER_IPV4_TCP
    expression: CSL__V__CSIPFILTER_IPV4_TCP
  - name: PLH_CSL_CSIPFILTER_IPV6_TCP
    expression: CSL__V__CSIPFILTER_IPV6_TCP

  - name: PLH_CSL_CSIPFILTER_IPV4_UDP
    expression: CSL__V__CSIPFILTER_IPV4_UDP
  - name: PLH_CSL_CSIPFILTER_IPV6_UDP
    expression: CSL__V__CSIPFILTER_IPV6_UDP

sections:
  - name: Auditing.MessageActions
    elements:
      - name: LOG_CSP_CSIPFILTER_HTTP
        references:
          - PLH_LOG_CSP_CSIPFILTER_HTTP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_HTTP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_HTTP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_HTTP

      - name: LOG_CSP_CSIPFILTER_TCP
        references:
          - PLH_LOG_CSP_CSIPFILTER_TCP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_TCP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_TCP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_TCP

      - name: LOG_CSP_CSIPFILTER_UDP
        references:
          - PLH_LOG_CSP_CSIPFILTER_UDP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_UDP INFO q{PLH_PSM_CS_UDP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_UDP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_UDP



      - name: LOG_CSP_CSIPFILTER_IPV4_HTTP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP

      - name: LOG_CSP_CSIPFILTER_IPV4_TCP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV4_TCP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_TCP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV4_TCP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_TCP

      - name: LOG_CSP_CSIPFILTER_IPV4_UDP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV4_UDP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_UDP INFO q{PLH_PSM_CS_UDP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV4_UDP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_UDP


      - name: LOG_CSP_CSIPFILTER_IPV6_HTTP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV6_HTTP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV6_HTTP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV6_HTTP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV6_HTTP

      - name: LOG_CSP_CSIPFILTER_IPV6_TCP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV6_TCP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV6_TCP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV6_TCP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV6_TCP

      - name: LOG_CSP_CSIPFILTER_IPV6_UDP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV6_UDP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV6_UDP INFO q{PLH_PSM_CS_UDP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV6_UDP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV6_UDP




  - name: TrafficManagement.ContentSwitching.ContentSwitchingPolicyLabels
    elements:
      - name: CSL_CSIPFILTER_HTTP
        references:
          - PLH_CSL_CSIPFILTER_HTTP
          - PLH_CSL_ENTRY_HTTP
        dependencies:
          - CSL_ENTRY_HTTP
          - CSP_CSIPFILTER_HTTP
        expressions:
          install: |
            add cs policylabel PLH_CSL_CSIPFILTER_HTTP HTTP
            bind cs policylabel PLH_CSL_ENTRY_HTTP PLH_CSP_CSIPFILTER_HTTP 2011 -invoke policylabel PLH_CSL_CSIPFILTER_HTTP
          uninstall: |
            unbind cs policylabel PLH_CSL_ENTRY_HTTP PLH_CSP_CSIPFILTER_HTTP
            rm cs policylabel PLH_CSL_CSIPFILTER_HTTP

      - name: CSL_CSIPFILTER_TCP
        references:
          - PLH_CSL_CSIPFILTER_TCP
          - PLH_CSL_ENTRY_TCP
        dependencies:
          - CSL_ENTRY_TCP
        expressions:
          install: |
            add cs policylabel PLH_CSL_CSIPFILTER_TCP TCP
          uninstall: |
            rm cs policylabel PLH_CSL_CSIPFILTER_TCP

      - name: CSL_CSIPFILTER_UDP
        references:
          - PLH_CSL_CSIPFILTER_UDP
          - PLH_CSL_ENTRY_UDP
        dependencies:
          - CSL_ENTRY_UDP
        expressions:
          install: |
            add cs policylabel PLH_CSL_CSIPFILTER_UDP UDP
          uninstall: |
            rm cs policylabel PLH_CSL_CSIPFILTER_UDP



      - name: CSL_CSIPFILTER_IPV4_HTTP
        references:
          - PLH_CSL_CSIPFILTER_IPV4_HTTP
        dependencies:
          - CSL_CSIPFILTER_HTTP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV4_HTTP HTTP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV4_HTTP

      - name: CSL_CSIPFILTER_IPV4_TCP
        references:
          - PLH_CSL_CSIPFILTER_IPV4_TCP
        dependencies:
          - CSL_CSIPFILTER_TCP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV4_TCP TCP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV4_TCP

      - name: CSL_CSIPFILTER_IPV4_UDP
        references:
          - PLH_CSL_CSIPFILTER_IPV4_UDP
        dependencies:
          - CSL_CSIPFILTER_UDP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV4_UDP UDP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV4_UDP



      - name: CSL_CSIPFILTER_IPV6_HTTP
        references:
          - PLH_CSL_CSIPFILTER_IPV6_HTTP
        dependencies:
          - CSL_CSIPFILTER_HTTP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV6_HTTP HTTP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV6_HTTP

      - name: CSL_CSIPFILTER_IPV6_TCP
        references:
          - PLH_CSL_CSIPFILTER_IPV6_TCP
        dependencies:
          - CSL_CSIPFILTER_TCP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV6_TCP TCP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV6_TCP

      - name: CSL_CSIPFILTER_IPV6_UDP
        references:
          - PLH_CSL_CSIPFILTER_IPV6_UDP
        dependencies:
          - CSL_CSIPFILTER_UDP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV6_UDP UDP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV6_UDP

  - name: TrafficManagement.ContentSwitching.ContentSwitchingPolicies
    elements:
      - name: CSP_CSIPFILTER_HTTP
        references:
          - PLH_CSP_CSIPFILTER_HTTP
          - PLH_LOG_CSP_CSIPFILTER_HTTP
        dependencies:
          - LOG_CSP_CSIPFILTER_HTTP
        expressions:
          install: add cs policy PLH_CSP_CSIPFILTER_HTTP -rule q{true} -logAction PLH_LOG_CSP_CSIPFILTER_HTTP
          uninstall: rm cs policy PLH_CSP_CSIPFILTER_HTTP