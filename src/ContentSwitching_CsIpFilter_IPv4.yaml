name: ContentSwitching_CsIpFilter_IPv4
dependencies:
  - Core
  # - ContentSwitchingEntry
  - ContentSwitching_CsIpFilter
placeholders:  
  - name: PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP
    expression: LOG__V__CSP_CSIPFILTER_IPV4_HTTP
  - name: PLH_LOG_CSP_CSIPFILTER_IPV4_TCP
    expression: LOG__V__CSP_CSIPFILTER_IPV4_TCP
  - name: PLH_LOG_CSP_CSIPFILTER_IPV4_UDP
    expression: LOG__V__CSP_CSIPFILTER_IPV4_UDP


  - name: PLH_CSP_CSIPFILTER_IPV4_HTTP
    expression: CSP__V__CSIPFILTER_IPV4_HTTP
  - name: PLH_CSP_CSIPFILTER_IPV4_TCP
    expression: CSP__V__CSIPFILTER_IPV4_TCP
  - name: PLH_CSP_CSIPFILTER_IPV4_UDP
    expression: CSP__V__CSIPFILTER_IPV4_UDP


  - name: PLH_CSL_CSIPFILTER_IPV4_HTTP
    expression: CSL__V__CSIPFILTER_IPV4_HTTP
  - name: PLH_CSL_CSIPFILTER_IPV6_HTTP
    expression: CSL__V__CSIPFILTER_IPV6_HTTP

  - name: PLH_CSL_CSIPFILTER_IPV4_TCP
    expression: CSL__V__CSIPFILTER_IPV4_TCP
  - name: PLH_CSL_CSIPFILTER_IPV6_TCP
    expression: CSL__V__CSIPFILTER_IPV6_TCP

  - name: PLH_CSL_CSIPFILTER_IPV4_UDP
    expression: CSL__V__CSIPFILTER_IPV4_UDP
  - name: PLH_CSL_CSIPFILTER_IPV6_UDP
    expression: CSL__V__CSIPFILTER_IPV6_UDP

sections:
  - name: Auditing.MessageActions
    elements:
      - name: LOG_CSP_CSIPFILTER_IPV4_HTTP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_HTTP

      - name: LOG_CSP_CSIPFILTER_IPV4_TCP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV4_TCP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_TCP INFO q{PLH_PSM_CS_TCP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV4_TCP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_TCP

      - name: LOG_CSP_CSIPFILTER_IPV4_UDP
        references:
          - PLH_LOG_CSP_CSIPFILTER_IPV4_UDP
        expressions:
          install: add audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_UDP INFO q{PLH_PSM_CS_UDP_KEY + "policy=PLH_LOG_CSP_CSIPFILTER_IPV4_UDP"}
          uninstall: rm audit messageAction PLH_LOG_CSP_CSIPFILTER_IPV4_UDP



  - name: TrafficManagement.ContentSwitching.ContentSwitchingPolicyLabels
    elements:
      - name: CSL_CSIPFILTER_IPV4_HTTP
        references:
          - PLH_CSL_CSIPFILTER_IPV4_HTTP
        dependencies:
          - CSL_CSIPFILTER_HTTP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV4_HTTP HTTP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV4_HTTP

      - name: CSL_CSIPFILTER_IPV4_TCP
        references:
          - PLH_CSL_CSIPFILTER_IPV4_TCP
        dependencies:
          - CSL_CSIPFILTER_TCP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV4_TCP TCP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV4_TCP

      - name: CSL_CSIPFILTER_IPV4_UDP
        references:
          - PLH_CSL_CSIPFILTER_IPV4_UDP
        dependencies:
          - CSL_CSIPFILTER_UDP
        expressions:
          install: add cs policylabel PLH_CSL_CSIPFILTER_IPV4_UDP UDP
          uninstall: rm cs policylabel PLH_CSL_CSIPFILTER_IPV4_UDP



  # - name: TrafficManagement.ContentSwitching.ContentSwitchingPolicies
  #   elements:
  #     - name: CSP_CSIPFILTER_HTTP
  #       references:
  #         - PLH_CSP_CSIPFILTER_HTTP
  #         - PLH_LOG_CSP_CSIPFILTER_HTTP
  #       dependencies:
  #         - LOG_CSP_CSIPFILTER_HTTP
  #       expressions:
  #         install: add cs policy PLH_CSP_CSIPFILTER_HTTP -rule q{true} -logAction PLH_LOG_CSP_CSIPFILTER_HTTP
  #         uninstall: rm cs policy PLH_CSP_CSIPFILTER_HTTP

  #     - name: CSP_CSIPFILTER_TCP
  #       references:
  #         - PLH_CSP_CSIPFILTER_TCP
  #         - PLH_LOG_CSP_CSIPFILTER_TCP
  #       dependencies:
  #         - LOG_CSP_CSIPFILTER_TCP
  #       expressions:
  #         install: add cs policy PLH_CSP_CSIPFILTER_TCP -rule q{true} -logAction PLH_LOG_CSP_CSIPFILTER_TCP
  #         uninstall: rm cs policy PLH_CSP_CSIPFILTER_TCP

  #     - name: CSP_CSIPFILTER_UDP
  #       references:
  #         - PLH_CSP_CSIPFILTER_UDP
  #         - PLH_LOG_CSP_CSIPFILTER_UDP
  #       dependencies:
  #         - LOG_CSP_CSIPFILTER_UDP
  #       expressions:
  #         install: add cs policy PLH_CSP_CSIPFILTER_UDP -rule q{true} -logAction PLH_LOG_CSP_CSIPFILTER_UDP
  #         uninstall: rm cs policy PLH_CSP_CSIPFILTER_UDP