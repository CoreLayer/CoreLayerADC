name: Demo
dependencies:
  - Core
  - ListenPolicies
placeholders:
sections:
  - name: AppExpert.Stringmap.Bindings
    elements:
      - name: TENANT__V__DEMO
        dependencies:
          - SM__V__TENANT
        expressions:
          install: bind policy stringmap SM__V__TENANT "tenant=TENANT__V__DEMO;" "state=ENABLED;"
          uninstall: unbind policy stringmap SM__V__TENANT "tenant=TENANT__V__DEMO;"

  - name: TrafficManagement.ContentSwitching.VirtualServers
    elements:
      - name: CS__V__DEMO_HTTP
        dependencies:
          - EXP__V__LPE_ENDPOINT_HTTP
        expressions:
          install: |
            add cs vserver CS__V__DEMO_HTTP HTTP 169.254.254.251 * -Listenpriority 15 -Listenpolicy "EXP__V__LPE_ENDPOINT_HTTP"
            bind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=80;type=HTTP;" "tenant=TENANT__V__DEMO;"
          uninstall: |
            rm cs vserver CS__V__DEMO_HTTP
            unbind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=80;type=HTTP;"

      - name: CS__V__DEMO_SSL
        dependencies:
          - EXP__V__LPE_ENDPOINT_SSL
        expressions:
          install: |
            add cs vserver CS__V__DEMO_SSL SSL 169.254.254.251 * -Listenpriority 25 -Listenpolicy "EXP__V__LPE_ENDPOINT_SSL"
            bind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=443;type=SSL;" "tenant=TENANT__V__DEMO;"
          uninstall: |
            rm cs vserver CS__V__DEMO_SSL
            unbind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=443;type=SSL;"

      - name: LB__V__DEMO_SSLBRIDGE
        dependencies:
          - EXP__V__LPE_ENDPOINT_SSLBRIDGE
        expressions:
          install: |
            add lb vserver LB__V__DEMO_SSLBRIDGE SSL_BRIDGE 169.254.254.251 443 -Listenpriority 21 -Listenpolicy "EXP__V__LPE_ENDPOINT_SSLBRIDGE"
            bind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=443;type=SSL_BRIDGE;" "tenant=TENANT__V__DEMO;"
          uninstall: |
            rm lb vserver LB__V__DEMO_SSLBRIDGE
            unbind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=443;type=SSL_BRIDGE;"

      - name: CS__V__DEMO_TCP
        dependencies:
          - EXP__V__LPE_ENDPOINT_TCP
        expressions:
          install: |
            add cs vserver CS__V__DEMO_TCP TCP 169.254.254.251 * -Listenpriority 35 -Listenpolicy "EXP__V__LPE_ENDPOINT_TCP"
            bind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=389;type=TCP;" "tenant=TENANT__V__DEMO;"
          uninstall: |
            rm cs vserver CS__V__DEMO_TCP
            unbind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=389;type=TCP;"

      - name: CS__V__DEMO_SSLTCP
        dependencies:
          - EXP__V__LPE_ENDPOINT_SSLTCP
        expressions:
          install: |
            add cs vserver CS__V__DEMO_SSLTCP SSL_TCP 169.254.254.251 * -Listenpriority 45 -Listenpolicy "EXP__V__LPE_ENDPOINT_SSLTCP"
            bind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=636;type=SSL_TCP;" "tenant=TENANT__V__DEMO;"
          uninstall: |
            rm cs vserver CS__V__DEMO_SSLTCP
            unbind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=636;type=SSL_TCP;"

      - name: CS__V__DEMO_UDP
        dependencies:
          - EXP__V__LPE_ENDPOINT_UDP
        expressions:
          install: |
            add cs vserver CS__V__DEMO_UDP UDP 169.254.254.251 * -Listenpriority 55 -Listenpolicy "EXP__V__LPE_ENDPOINT_UDP"
            bind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=514;type=UDP;" "tenant=TENANT__V__DEMO;"
          uninstall: |
            rm cs vserver CS__V__DEMO_UDP
            unbind policy stringmap SM__V__TENANT_ENDPOINTS "ip=169.254.254.251;dstport=514;type=UDP;"