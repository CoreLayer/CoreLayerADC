name: ListenPolicies
dependencies:
  - Core
placeholders:   
sections:
  - name: AppExpert.AdvancedExpressions
    elements:
      ############################################################
      # LISTEN POLICIES
      # HTTP
      - name: EXP__V__LPE_ENDPOINT_HTTP
        references:
          - PLH_IPV4_ENDPOINT_HTTP
          - PLH_IPV4_ENDPOINT_HTTP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_HTTP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_HTTP_IS_ENABLED
          - PLH_IPV6_ENDPOINT_HTTP
          - PLH_IPV6_ENDPOINT_HTTP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_HTTP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_HTTP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_HTTP q{(PLH_IPV4_ENDPOINT_HTTP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_HTTP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_HTTP_IS_ENABLED) || (PLH_IPV6_ENDPOINT_HTTP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_HTTP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_HTTP_IS_ENABLED)}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_HTTP

      # SSL
      - name: EXP__V__LPE_ENDPOINT_SSL
        references:
          - PLH_IPV4_ENDPOINT_SSL
          - PLH_IPV4_ENDPOINT_SSL_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_SSL_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_SSL_IS_ENABLED
          - PLH_IPV6_ENDPOINT_SSL
          - PLH_IPV6_ENDPOINT_SSL_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_SSL_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_SSL_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_SSL q{(PLH_IPV4_ENDPOINT_SSL_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_SSL_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_SSL_IS_ENABLED) || (PLH_IPV6_ENDPOINT_SSL_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_SSL_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_SSL_IS_ENABLED)}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_SSL

      # SSL_BRDIGE
      - name: EXP__V__LPE_ENDPOINT_SSLBRIDGE
        references:
          - PLH_IPV4_ENDPOINT_SSLBRIDGE
          - PLH_IPV4_ENDPOINT_SSLBRIDGE_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_SSLBRIDGE_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_SSLBRIDGE_IS_ENABLED
          - PLH_IPV6_ENDPOINT_SSLBRIDGE
          - PLH_IPV6_ENDPOINT_SSLBRIDGE_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_SSLBRIDGE_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_SSLBRIDGE_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_SSLBRIDGE q{(PLH_IPV4_ENDPOINT_SSLBRIDGE_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_SSLBRIDGE_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_SSLBRIDGE_IS_ENABLED) || (PLH_IPV6_ENDPOINT_SSLBRIDGE_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_SSLBRIDGE_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_SSLBRIDGE_IS_ENABLED)}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_SSLBRIDGE

      # TCP
      - name: EXP__V__LPE_ENDPOINT_TCP
        references:
          - PLH_IPV4_ENDPOINT_TCP
          - PLH_IPV4_ENDPOINT_TCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_TCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_TCP_IS_ENABLED
          - PLH_IPV6_ENDPOINT_TCP
          - PLH_IPV6_ENDPOINT_TCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_TCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_TCP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_TCP q{(PLH_IPV4_ENDPOINT_TCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_TCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_TCP_IS_ENABLED) || (PLH_IPV6_ENDPOINT_TCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_TCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_TCP_IS_ENABLED)}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_TCP

      # SSL_TCP
      - name: EXP__V__LPE_ENDPOINT_SSLTCP
        references:
          - PLH_IPV4_ENDPOINT_SSLTCP
          - PLH_IPV4_ENDPOINT_SSLTCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_SSLTCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_SSLTCP_IS_ENABLED
          - PLH_IPV6_ENDPOINT_SSLTCP
          - PLH_IPV6_ENDPOINT_SSLTCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_SSLTCP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_SSLTCP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_SSLTCP q{(PLH_IPV4_ENDPOINT_SSLTCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_SSLTCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_SSLTCP_IS_ENABLED) || (PLH_IPV6_ENDPOINT_SSLTCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_SSLTCP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_SSLTCP_IS_ENABLED)}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_SSLTCP

      # UDP
      - name: EXP__V__LPE_ENDPOINT_UDP
        references:
          - PLH_IPV4_ENDPOINT_UDP
          - PLH_IPV4_ENDPOINT_UDP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_UDP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV4_ENDPOINT_UDP_IS_ENABLED
          - PLH_IPV6_ENDPOINT_UDP
          - PLH_IPV6_ENDPOINT_UDP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_UDP_IS_CONFIGURED
          - PLH_TENANT_FROM_IPV6_ENDPOINT_UDP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_UDP q{(PLH_IPV4_ENDPOINT_UDP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_UDP_IS_CONFIGURED && PLH_TENANT_FROM_IPV4_ENDPOINT_UDP_IS_ENABLED) || (PLH_IPV6_ENDPOINT_UDP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_UDP_IS_CONFIGURED && PLH_TENANT_FROM_IPV6_ENDPOINT_UDP_IS_ENABLED)}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_UDP