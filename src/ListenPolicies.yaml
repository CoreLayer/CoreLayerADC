name: ListenPolicies
dependencies:
  - Core
placeholders:   
sections:
  - name: AppExpert.AdvancedExpressions
    elements:
      - name: EXP__V__LPE_ENDPOINT_HTTP
        references:
          - PLH_ENDPOINT_HTTP
          - PLH_ENDPOINT_HTTP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_HTTP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_HTTP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_HTTP q{PLH_ENDPOINT_HTTP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_HTTP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_HTTP_IS_ENABLED}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_HTTP
      - name: EXP__V__LPE_ENDPOINT_SSL
        references:
          - PLH_ENDPOINT_SSL
          - PLH_ENDPOINT_SSL_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_SSL_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_SSL_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_SSL q{PLH_ENDPOINT_SSL_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_SSL_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_SSL_IS_ENABLED}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_SSL
      - name: EXP__V__LPE_ENDPOINT_SSLBRIDGE
        references:
          - PLH_ENDPOINT_SSLBRIDGE
          - PLH_ENDPOINT_SSLBRIDGE_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_SSLBRIDGE_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_SSLBRIDGE_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_SSLBRIDGE q{PLH_ENDPOINT_SSLBRIDGE_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_SSLBRIDGE_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_SSLBRIDGE_IS_ENABLED}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_SSLBRIDGE
      - name: EXP__V__LPE_ENDPOINT_TCP
        references:
          - PLH_ENDPOINT_TCP
          - PLH_ENDPOINT_TCP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_TCP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_TCP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_TCP q{PLH_ENDPOINT_TCP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_TCP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_TCP_IS_ENABLED}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_TCP
      - name: EXP__V__LPE_ENDPOINT_SSLTCP
        references:
          - PLH_ENDPOINT_SSLTCP
          - PLH_ENDPOINT_SSLTCP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_SSLTCP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_SSLTCP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_SSLTCP q{PLH_ENDPOINT_SSLTCP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_SSLTCP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_SSLTCP_IS_ENABLED}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_SSLTCP
      - name: EXP__V__LPE_ENDPOINT_UDP
        references:
          - PLH_ENDPOINT_UDP
          - PLH_ENDPOINT_UDP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_UDP_IS_CONFIGURED
          - PLH_TENANT_FROM_ENDPOINT_UDP_IS_ENABLED
        dependencies:
          - SM__V__TENANT_ENDPOINTS
          - SM__V__TENANT
        expressions:
          install: add policy expression EXP__V__LPE_ENDPOINT_UDP q{PLH_ENDPOINT_UDP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_UDP_IS_CONFIGURED && PLH_TENANT_FROM_ENDPOINT_UDP_IS_ENABLED}
          uninstall: rm policy expression EXP__V__LPE_ENDPOINT_UDP