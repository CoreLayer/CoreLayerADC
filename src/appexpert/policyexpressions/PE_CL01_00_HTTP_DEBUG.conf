# dependency:/src/appexpert/stringmaps/SM_CL01_00_KEYS.conf
# dependency:/src/appexpert/variables/VAR_CL01_00_L8_HTTP.conf
add policy expression PE_CL01_00_HTTP_DEBUG q{HTTP.REQ.HEADER("X-CORELAYER-DEBUG").EXISTS && HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN").EXISTS}

add policy expression PE_CL01_00_HTTP_DEBUG_CREATE_TOKEN q{HTTP.REQ.HEADER("X-CORELAYER-DEBUG").TO_LOWER.EQ("register")}
add policy expression PE_CL01_00_HTTP_DEBUG_NEW_TOKEN q{((HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN").B64ENCODE + SYS.UUID.B64ENCODE) + SYS.NANO_TIME).B64ENCODE}
add policy expression PE_CL01_00_HTTP_DEBUG_STORE_TOKEN q{HTTP.REQ.HEADER("X-CORELAYER-DEBUG").TO_LOWER.EQ("register") && HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN").IS_STRINGMAP_KEY("SM_CL01_00_KEYS")}
add policy expression PE_CL01_00_HTTP_DEBUG_RETURN_TOKEN q{HTTP.REQ.HEADER("X-CORELAYER-DEBUG").TO_LOWER.EQ("register") && HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN").IS_STRINGMAP_KEY("SM_CL01_00_KEYS")}

add policy expression PE_CL01_00_HTTP_DEBUG_HTML q{$VAR_CL01_00_L8_HTTP_DEBUG_TOKENS.valueExists(HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN")) && HTTP.REQ.HEADER("X-CORELAYER-DEBUG").TO_LOWER.EQ("html")}
add policy expression PE_CL01_00_HTTP_DEBUG_JSON q{$VAR_CL01_00_L8_HTTP_DEBUG_TOKENS.valueExists(HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN")) && HTTP.REQ.HEADER("X-CORELAYER-DEBUG").TO_LOWER.EQ("json")}
add policy expression PE_CL01_00_HTTP_DEBUG_HEAD q{$VAR_CL01_00_L8_HTTP_DEBUG_TOKENS.valueExists(HTTP.REQ.HEADER("X-CORELAYER-DEBUG-TOKEN")) && HTTP.REQ.HEADER("X-CORELAYER-DEBUG").TO_LOWER.EQ("header")}

# General HTML OUTPUT expressions
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_002 q{"<table class=\"variables layer2\" border=\"1\" style=\"width: 1500px\"><caption><b>Layer 2 information</b></caption><thead><th>Variable</th><th>Value</th></thead><tbody>"}
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_003 q{"<table class=\"variables layer3\" border=\"1\" style=\"width: 1500px\"><caption><b>Layer 3 information</b></caption><thead><th>Variable</th><th>Value</th></thead><tbody>"}
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_004 q{"<table class=\"variables layer4\" border=\"1\" style=\"width: 1500px\"><caption><b>Layer 4 information</b></caption><thead><th>Variable</th><th>Value</th></thead><tbody>"}
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_005 q{"<table class=\"variables layer5\" border=\"1\" style=\"width: 1500px\"><caption><b>Layer 5 information</b></caption><thead><th>Variable</th><th>Value</th></thead><tbody>"}
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_007 q{"<table class=\"variables layer7\" border=\"1\" style=\"width: 1500px\"><caption><b>Layer 7 information</b></caption><thead><th>Variable</th><th>Value</th></thead><tbody>"}
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_008 q{"<table class=\"variables layer8\" border=\"1\" style=\"width: 1500px\"><caption><b>Layer 8 information</b></caption><thead><th>Variable</th><th>Value</th></thead><tbody>"}
add policy expression PE_CL01_00_HTTP_DEBUG_HTML_999 q{"</tbody></table></br>"}

# # L2 HTML OUTPUT
# # dependency:/src/appexpert/variables/VAR_CL01_00_L2.conf
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_021 q{"<tr><td>VLAN</td><td>" + $VAR_CL01_00_L2_VLAN + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_022 q{"<tr><td>SRC MAC</td><td>" + $VAR_CL01_00_L2_SRCMAC + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_023 q{"<tr><td>DST MAC</td><td>" + $VAR_CL01_00_L2_DSTMAC + "</td></tr>"}

# # L3 HTML OUTPUT
# # dependency:/src/appexpert/variables/VAR_CL01_00_L3.conf
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_031 q{"<tr><td>IP VERSION</td><td>" + $VAR_CL01_00_L3_IPVERSION + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_032 q{"<tr><td>IP ADDRESS</td><td>" + $VAR_CL01_00_L3_IPADDRESS + "</td></tr>"}

# # L4 HTML OUTPUT
# # dependency:/src/appexpert/variables/VAR_CL01_00_L4.conf
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_041 q{"<tr><td>PROTOCOL</td><td>" + $VAR_CL01_00_L4_PROTOCOL + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_042 q{"<tr><td>SRC PORT</td><td>" + $VAR_CL01_00_L4_SRCPORT + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_043 q{"<tr><td>DST PORT</td><td>" + $VAR_CL01_00_L4_DSTPORT + "</td></tr>"}

# # L5 HTML OUTPUT
# # dependency:/src/appexpert/variables/VAR_CL01_00_L5.conf
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_051 q{"<tr><td>CIPHER NAME</td><td>" + $VAR_CL01_00_L5_SSL_CIPHER + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_052 q{"<tr><td>CIPHER BITS</td><td>" + $VAR_CL01_00_L5_SSL_BITS + "</td></tr>"}

# # L7 HTML OUTOUT
# # dependency:/src/appexpert/variables/VAR_CL01_00_L7_HTTP.conf
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_071 q{"<tr><td>FQDN</td><td>" + $VAR_CL01_00_L7_HTTP_FQDN + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_072 q{"<tr><td>PATH_FULL</td><td>" + $VAR_CL01_00_L7_HTTP_PATH_FULL + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_073 q{"<tr><td>PATH_SCND</td><td>" + $VAR_CL01_00_L7_HTTP_PATH_SCND + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_074 q{"<tr><td>PATH_FRST</td><td>" + $VAR_CL01_00_L7_HTTP_PATH_FRST + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_075 q{"<tr><td>QUERY</td><td>" + $VAR_CL01_00_L7_HTTP_QUERY + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_076 q{"<tr><td>USER-AGENT</td><td>" + $VAR_CL01_00_L7_HTTP_UA + "</td></tr>"}

# # L8 HTML OUTPUT
# # dependency:/src/appexpert/variables/VAR_CL01_00_L8.conf
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_201 q{"<tr><td>CS</td><td>" + $VAR_CL01_00_L8_CS + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_202 q{"<tr><td>LB</td><td>" + $VAR_CL01_00_L8_LB + "</td></tr>"}

# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_211 q{"<tr><td>CSGROUP - IPFILTER</td><td>" + $VAR_CL01_00_L8_CSGROUP_IPFILTER + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_212 q{"<tr><td>CS - IPFILTER</td><td>" + $VAR_CL01_00_L8_CS_IPFILTER + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_213 q{"<tr><td>LBGROUP - IPFILTER</td><td>" + $VAR_CL01_00_L8_LBGROUP_IPFILTER + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_214 q{"<tr><td>LB - IPFILTER</td><td>" + $VAR_CL01_00_L8_LB_IPFILTER + "</td></tr>"}


# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1032 q{"<tr><td>IPV4 - 032</td><td>" + $VAR_CL01_00_L3_IPV4_032 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1031 q{"<tr><td>IPV4 - 031</td><td>" + $VAR_CL01_00_L3_IPV4_031 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1030 q{"<tr><td>IPV4 - 030</td><td>" + $VAR_CL01_00_L3_IPV4_030 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1029 q{"<tr><td>IPV4 - 029</td><td>" + $VAR_CL01_00_L3_IPV4_029 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1028 q{"<tr><td>IPV4 - 028</td><td>" + $VAR_CL01_00_L3_IPV4_028 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1027 q{"<tr><td>IPV4 - 027</td><td>" + $VAR_CL01_00_L3_IPV4_027 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1026 q{"<tr><td>IPV4 - 026</td><td>" + $VAR_CL01_00_L3_IPV4_026 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1025 q{"<tr><td>IPV4 - 025</td><td>" + $VAR_CL01_00_L3_IPV4_025 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1024 q{"<tr><td>IPV4 - 024</td><td>" + $VAR_CL01_00_L3_IPV4_024 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1023 q{"<tr><td>IPV4 - 023</td><td>" + $VAR_CL01_00_L3_IPV4_023 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1022 q{"<tr><td>IPV4 - 022</td><td>" + $VAR_CL01_00_L3_IPV4_022 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1021 q{"<tr><td>IPV4 - 021</td><td>" + $VAR_CL01_00_L3_IPV4_021 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1020 q{"<tr><td>IPV4 - 020</td><td>" + $VAR_CL01_00_L3_IPV4_020 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1019 q{"<tr><td>IPV4 - 019</td><td>" + $VAR_CL01_00_L3_IPV4_019 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1018 q{"<tr><td>IPV4 - 018</td><td>" + $VAR_CL01_00_L3_IPV4_018 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1017 q{"<tr><td>IPV4 - 017</td><td>" + $VAR_CL01_00_L3_IPV4_017 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1016 q{"<tr><td>IPV4 - 016</td><td>" + $VAR_CL01_00_L3_IPV4_016 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1015 q{"<tr><td>IPV4 - 015</td><td>" + $VAR_CL01_00_L3_IPV4_015 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1014 q{"<tr><td>IPV4 - 014</td><td>" + $VAR_CL01_00_L3_IPV4_014 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1013 q{"<tr><td>IPV4 - 013</td><td>" + $VAR_CL01_00_L3_IPV4_013 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1012 q{"<tr><td>IPV4 - 012</td><td>" + $VAR_CL01_00_L3_IPV4_012 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1011 q{"<tr><td>IPV4 - 011</td><td>" + $VAR_CL01_00_L3_IPV4_011 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1010 q{"<tr><td>IPV4 - 010</td><td>" + $VAR_CL01_00_L3_IPV4_010 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1009 q{"<tr><td>IPV4 - 009</td><td>" + $VAR_CL01_00_L3_IPV4_009 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1008 q{"<tr><td>IPV4 - 008</td><td>" + $VAR_CL01_00_L3_IPV4_008 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1007 q{"<tr><td>IPV4 - 007</td><td>" + $VAR_CL01_00_L3_IPV4_007 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1006 q{"<tr><td>IPV4 - 006</td><td>" + $VAR_CL01_00_L3_IPV4_006 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1005 q{"<tr><td>IPV4 - 005</td><td>" + $VAR_CL01_00_L3_IPV4_005 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1004 q{"<tr><td>IPV4 - 004</td><td>" + $VAR_CL01_00_L3_IPV4_004 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1003 q{"<tr><td>IPV4 - 003</td><td>" + $VAR_CL01_00_L3_IPV4_003 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1002 q{"<tr><td>IPV4 - 002</td><td>" + $VAR_CL01_00_L3_IPV4_002 + "</td></tr>"}
# add policy expression PE_CL01_00_HTTP_DEBUG_HTML_1001 q{"<tr><td>IPV4 - 001</td><td>" + $VAR_CL01_00_L3_IPV4_001 + "</td></tr>"}






add policy expression PE_CL01_00_HTTP_DEBUG_JSON_00 q/"{"/
add policy expression PE_CL01_00_HTTP_DEBUG_JSON_99 q/"}"/
