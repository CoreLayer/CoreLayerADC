# dependency:/src/appexpert/patternsets/PS_CL01_00_CS_PREFIX.conf
# dependency:/src/appexpert/patternsets/PS_CL01_00_LB_PREFIX.conf

# dependency:/src/appexpert/stringmaps/SM_CL01_00_CS.conf
# dependency:/src/appexpert/stringmaps/SM_CL01_00_LB.conf

# dependency:/src/appexpert/stringmaps/SM_CL01_00_LBGROUP.conf
# dependency:/src/appexpert/stringmaps/SM_CL01_00_CS.conf
add policy expression PE_CL01_00_L8_HTTP_TX q{HTTP.REQ.TXID}

add policy expression PE_CL01_00_L8_HTTP_KEY q{"SM_CS_FLOW - KEY"}
add policy expression PE_CL01_00_L8_HTTP_VAL q{"SM_CS_FLOW - VALUE"}
add policy expression PE_CL01_00_L8_HTTP_ACTION q{"SM_CS_FLOW - ACTION"}
add policy expression PE_CL01_00_L8_HTTP_DST q{"SM_CS_FLOW - DESTINATION"}

add policy expression PE_CL01_00_L8_HTTP_CSGROUP q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").TO_LOWER}
add policy expression PE_CL01_00_L8_HTTP_CS q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER}
add policy expression PE_CL01_00_L8_HTTP_LBGROUP q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").TO_LOWER}
add policy expression PE_CL01_00_L8_HTTP_LB q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER}

## IPFILTER DEFINITIONS
# SPECIFIC - HTTP
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CSGROUP q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("ipfilter=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CS q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("ipfilter=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LBGROUP q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("ipfilter=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LB q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("ipfilter=").BEFORE_STR(";")}

add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CSGROUP_ACTION q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("ipfilter_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CS_ACTION q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("ipfilter_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LBGROUP_ACTION q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("ipfilter_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LB_ACTION q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("ipfilter_action_http=").BEFORE_STR(";")}

add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CSGROUP_ACTION_DST q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("ipfilter_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CS_ACTION_DST q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("ipfilter_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LBGROUP_ACTION_DST q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("ipfilter_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LB_ACTION_DST q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("ipfilter_action_dst_http=").BEFORE_STR(";")}

## NO SERVICE DEFINITIONS
# SPECIFIC - HTTP
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CSGROUP_ACTION q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("noservice_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CS_ACTION q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("noservice_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LBGROUP_ACTION q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("noservice_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LB_ACTION q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("noservice_action_http=").BEFORE_STR(";")}

add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CSGROUP_ACTION_DST q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("noservice_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CS_ACTION_DST q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("noservice_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LBGROUP_ACTION_DST q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("noservice_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LB_ACTION_DST q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("noservice_action_dst_http=").BEFORE_STR(";")}

## MAINTENANCE DEFINITIONS
# SPECIFIC - HTTP
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CSGROUP_ACTION q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("maintenance_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CS_ACTION q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("maintenance_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LBGROUP_ACTION q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("maintenance_action_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LB_ACTION q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("maintenance_action_http=").BEFORE_STR(";")}
# TODO
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_FLOW_ACTION q{"none"}

add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CSGROUP_ACTION_DST q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("csgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_CSGROUP").AFTER_STR("maintenance_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CS_ACTION_DST q{CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_CS").AFTER_STR("maintenance_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LBGROUP_ACTION_DST q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("lbgroup=").BEFORE_STR(";").MAP_STRING("SM_CL01_00_LBGROUP").AFTER_STR("maintenance_action_dst_http=").BEFORE_STR(";")}
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LB_ACTION_DST q{CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_LB_PREFIX").TO_LOWER.MAP_STRING("SM_CL01_00_LB").AFTER_STR("maintenance_action_dst_http=").BEFORE_STR(";")}
# TODO
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_FLOW_ACTION_DST q{"none"}