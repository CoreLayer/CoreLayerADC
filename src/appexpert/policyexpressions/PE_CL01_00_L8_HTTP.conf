# dependency:/src/appexpert/patternsets/PS_CL01_00_CS_PREFIX.conf
# dependency:/src/appexpert/patternsets/PS_CL01_00_LB_PREFIX.conf

# dependency:/src/appexpert/stringmaps/SM_CL01_00_CS.conf
# dependency:/src/appexpert/stringmaps/SM_CL01_00_LB.conf

# dependency:/src/appexpert/stringmaps/SM_CL01_00_LBGROUP.conf
# dependency:/src/appexpert/stringmaps/SM_CL01_00_CS.conf
add policy expression PE_CL01_00_L8_HTTP_TX HTTP.REQ.TXID
add policy expression PE_CL01_00_L8_HTTP_CS CLIENT.TCP.CS_VSERVER.NAME.TO_LOWER
add policy expression PE_CL01_00_L8_HTTP_LB CLIENT.TCP.LB_VSERVER.NAME.TO_LOWER

add policy expression PE_CL01_00_L8_HTTP_KEY "\"SM_CS_FLOW - KEY\""
add policy expression PE_CL01_00_L8_HTTP_VAL "\"SM_CS_FLOW - VALUE\""
add policy expression PE_CL01_00_L8_HTTP_ACTION "\"SM_CS_FLOW - ACTION\""
add policy expression PE_CL01_00_L8_HTTP_DST "\"SM_CS_FLOW - DESTINATION\""


add policy expression PE_CL01_00_L8_HTTP_CSGROUP "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").TO_LOWER"
add policy expression PE_CL01_00_L8_HTTP_CS "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER"
add policy expression PE_CL01_00_L8_HTTP_LBGROUP "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").TO_LOWER"
add policy expression PE_CL01_00_L8_HTTP_LB "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER"

## IPFILTER DEFINITIONS
# SPECIFIC - HTTP
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CSGROUP_ACTION "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_CSGROUP\").AFTER_STR(\"ipfilter_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CS_ACTION "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"ipfilter_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LBGROUP_ACTION "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_LBGROUP\").AFTER_STR(\"ipfilter_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LB_ACTION "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"ipfilter_action_http=\").BEFORE_STR(\";\")"

add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CSGROUP_ACTION_DST "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_CSGROUP\").AFTER_STR(\"ipfilter_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_CS_ACTION_DST "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"ipfilter_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LBGROUP_ACTION_DST "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_LBGROUP\").AFTER_STR(\"ipfilter_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_IPFILTER_LB_ACTION_DST "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"ipfilter_action_dst_http=\").BEFORE_STR(\";\")"

## NO SERVICE DEFINITIONS
# SPECIFIC - HTTP
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CSGROUP_ACTION "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_CSGROUP\").AFTER_STR(\"noservice_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CS_ACTION "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"noservice_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LBGROUP_ACTION "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_LBGROUP\").AFTER_STR(\"noservice_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LB_ACTION "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"noservice_action_http=\").BEFORE_STR(\";\")"

add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CSGROUP_ACTION_DST "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_CSGROUP\").AFTER_STR(\"noservice_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_CS_ACTION_DST "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"noservice_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LBGROUP_ACTION_DST "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_LBGROUP\").AFTER_STR(\"noservice_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_NOSERVICE_LB_ACTION_DST "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"noservice_action_dst_http=\").BEFORE_STR(\";\")"

## MAINTENANCE DEFINITIONS
# SPECIFIC - HTTP
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CSGROUP_ACTION "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_CSGROUP\").AFTER_STR(\"maintenance_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CS_ACTION "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"maintenance_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LBGROUP_ACTION "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_LBGROUP\").AFTER_STR(\"maintenance_action_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LB_ACTION "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"maintenance_action_http=\").BEFORE_STR(\";\")"
# TODO
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_FLOW_ACTION "\"none\""

add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CSGROUP_ACTION_DST "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"csgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_CSGROUP\").AFTER_STR(\"maintenance_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_CS_ACTION_DST "CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_CS_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_CS\").AFTER_STR(\"maintenance_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LBGROUP_ACTION_DST "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"lbgroup=\").BEFORE_STR(\";\").MAP_STRING(\"SM_CL01_00_LBGROUP\").AFTER_STR(\"maintenance_action_dst_http=\").BEFORE_STR(\";\")"
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_LB_ACTION_DST "CLIENT.TCP.LB_VSERVER.NAME.AFTER_STR_ANY(\"PS_CL01_00_LB_PREFIX\").TO_LOWER.MAP_STRING(\"SM_CL01_00_LB\").AFTER_STR(\"maintenance_action_dst_http=\").BEFORE_STR(\";\")"
# TODO
add policy expression PE_CL01_00_L8_HTTP_MAINTENANCE_FLOW_ACTION_DST "\"none\""