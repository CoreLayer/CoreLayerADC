###############################################################################
### PE_CL01_00_L8_HTTP_UAD.conf ###
###############################################################################
### DEPENDENCIES ###
# dependency:/src/appexpert/patternsets/PS_CL01_00_CS_PREFIX.conf
# dependency:/src/appexpert/stringmaps/SM_CL01_00_CSCONTROL.conf
###############################################################################
### DESCRIPTION ###
#   Policy expressions for CoreLayer HTTP content-switching with default user-agent
###############################################################################
add policy expression PE_CL01_00_HTTP_ZONE_0FA_FULL_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_SCND_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1) + "/" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_FRST_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_FQDN_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_WILD_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=*." + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}

add policy expression PE_CL01_00_HTTP_ZONE_1FA_FULL_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_SCND_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1) + "/" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_FRST_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_FQDN_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_WILD_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=*." + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}

add policy expression PE_CL01_00_HTTP_ZONE_2FA_FULL_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_SCND_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1) + "/" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_FRST_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_FQDN_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_WILD_UAD_TARGET q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=*." + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.MAP_STRING("SM_CL01_00_CSCONTROL").AFTER_STR("target=").BEFORE_STR(";")}





add policy expression PE_CL01_00_HTTP_ZONE_0FA_FULL_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_SCND_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1) + "/" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_FRST_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_FQDN_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_0FA_WILD_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=0fa;ua=uad;req=*." + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}

add policy expression PE_CL01_00_HTTP_ZONE_1FA_FULL_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_SCND_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1) + "/" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_FRST_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_FQDN_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_1FA_WILD_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=1fa;ua=uad;req=*." + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}

add policy expression PE_CL01_00_HTTP_ZONE_2FA_FULL_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + HTTP.REQ.URL.PATH).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_SCND_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1) + "/" + HTTP.REQ.URL.PATH.GET(2)).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_FRST_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER + "/" + HTTP.REQ.URL.PATH.GET(1)).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_FQDN_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=" + HTTP.REQ.HOSTNAME.SERVER).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}
add policy expression PE_CL01_00_HTTP_ZONE_2FA_WILD_UAD_KEY q{("cs=" + CLIENT.TCP.CS_VSERVER.NAME.AFTER_STR_ANY("PS_CL01_00_CS_PREFIX") + ";zone=2fa;ua=uad;req=*." + HTTP.REQ.HOSTNAME.DOMAIN).TO_LOWER.IS_STRINGMAP_KEY("SM_CL01_00_CSCONTROL")}