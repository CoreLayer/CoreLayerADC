###############################################################################
### RSPL_CL01_00_HTTP_REQ.conf ###
###############################################################################
### DESCRIPTION ###
# Execution flow for HTTP/SSL traffic:
#   Check if all objects are configured
#   Check if debug is enabled
#   Check if the client is allowed access based on IP address
#   Check if maintenance is activated for the current request
#   Check if a custom action is configured for the current request
#   Check if the request cannot be served
###############################################################################

# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_REQ.conf
 add responder policylabel RSPL_CL01_00_HTTP_REQ -policylabeltype HTTP

# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_NOT_CONFIGURED.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_NOT_CONFIGURED 1011 END

# Allow the registration of new debugging tokens for HTTP traffic using Request Headers:
#   X-CORELAYER-DEBUG
#   X-CORELAYER-DEBUG-TOKEN
# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_DEBUG_REGISTRATION.conf
# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_DEBUG_REGISTRATION.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_DEBUG_REGISTRATION 1021 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_DEBUG_REGISTRATION

# Check if an IP Filter is configured for the following objects:
#   CSGROUP
#   CS
#   LBGROUP
#   LB
# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_IPFILTER.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_IPFILTER 1041 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_IPFILTER

# # Check if an Authorization Group Filter is configured
# # dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_AUTHFILTER.conf
# bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_AUTHFILTER 1051 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_AUTHFILTER

# Check if maintenance mode is enabled for the following objects:
#   CSGROUP
#   CS
#   LBGROUP
#   LB
# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_MAINTENANCE.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_MAINTENANCE 1061 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_MAINTENANCE

# # Check if the path starts with /corelayer/01/00/media
# # dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_MEDIA.conf
# bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_MEDIA 1071 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_MEDIA

# Check if the default load balancer for the current content-switching virtual was hit
#   Use cases:
#       CSCONTROL - DROP
#       CSCONTROL - RESET
#       CSCONTROL - BLOCK (show a custom page)
#       CSCONTROL - REDIR307 / REDIR307_KP / REDIR307_KPQ / REDIR307_KQ / REDIR307_SWITCH
#       CSCONTROL - REDIR308 / REDIR308_KP / REDIR308_KPQ / REDIR308_KQ / REDIR308_SWITCH
# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_CSCONTROL.conf
# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_CSCONTROL.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_CSCONTROL 1022 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_CSCONTROL

# # Check if the default load balancer for the current content-switching virtual was hit
# #   Use cases:
# #       NOSERVICE / NOCONFIG
# # dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_NOSERVICE.conf
# bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_NOSERVICE 1091 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_NOSERVICE