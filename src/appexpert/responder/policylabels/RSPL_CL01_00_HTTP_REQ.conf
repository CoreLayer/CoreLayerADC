###############################################################################
### RSPL_CL01_00_HTTP_REQ.conf ###
###############################################################################
### DESCRIPTION ###
# Execution flow for HTTP/SSL traffic:
#   Check if all objects are configured
#   Set all variables to be used in future expressions
#   Check if debug is enabled
#   Check if the client is allowed access based on IP address
#   Check if a custom action is configured for the current request
#   Check if maintenance is activated for the current request
#   Check if the request cannot be served
###############################################################################

# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_REQ.conf
 add responder policylabel RSPL_CL01_00_HTTP_REQ -policylabeltype HTTP

# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_NOT_CONFIGURED.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_NOT_CONFIGURED 100 END

# dependency:/src/appexpert/responder/policies/RSP_CL01_00_SET_L0.conf
# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_SET_L0.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_SET_L0 101 NEXT -invoke policylabel RSPL_CL01_00_HTTP_SET_L0

# dependency:/src/appexpert/responder/policies/RSP_CL01_00_HTTP_DEBUG.conf
# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_DEBUG.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_HTTP_DEBUG 201 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_DEBUG

# dependency:/src/appexpert/responder/policylabels/RSPL_CL01_00_HTTP_IPFILTER.conf
bind responder policylabel RSPL_CL01_00_HTTP_REQ RSP_CL01_00_TCP_IPFILTER 301 USE_INVOCATION_RESULT -invoke policylabel RSPL_CL01_00_HTTP_IPFILTER


# Check if selected LB is a custom action: VS_REDIR / VS_DROP / VS_RESET / VS_BLOCKED

# Check if maintenance is active

# Check if selected LB is VS_NOSERVICE